**事务**是用户定义的一个数据库操作序列，**这些操作要么全做，要么全不做**，是一个不可分割的工作单位。在关系数据库中，一个事务可以是一条 SQL 语句、一组 SQL 语句或整个程序。事务具有 4 个特性：原子性、一致性、隔离性和持续性，简称为 **ACID 特性**。

| ACID 特性 | 说明                                           |
| ------- | -------------------------------------------- |
| 原子性     | 事务是数据库的逻辑工作单位，事务中的操作要么都做，要么都不做               |
| 一致性     | 事务执行的结果必须是使数据库从一个一致性状态变到另一个一致性状态             |
| 隔离性     | 一个事务的内部操作及使用的数据对其他并发事务是隔离的，并发执行的各个事务之间不能互相干扰 |
| 持续性     | 一个事务一旦提交，它对数据库中数据的改变就应该是永久性的                 |
事务是恢复和并发控制的基本单位，保证事务 ACID 特性是事务管理的重要任务。事务 ACID 特性可能遭到破坏的因素有：

1. 不同事务的操作交叉执行。此时数据库管理系统必须保证多个事务的交叉运行，不影响这些事务的原子性。
2. 事务在运行过程中被强行停止，数据库管理系统必须保证被强行终止的事务对数据库和其他事务没有任何影响。

在 SQL 语句中，事务通常是以 BEGIN TRANSACTION 开始，以 COMMIT 或 ROLLBACK 结束。COMMIT 表示提交，将事务中所有对数据库的更新写回到磁盘上的物理数据库中去，事务正常结束。ROLLBACK 表示回滚，即在事务运行的过程中发生了某种故障，系统将事务中对数据库的所有已完成的操作全部撤销，回滚到事务开始时的状态。


## 数据库故障

 (1)<strong>事务内部的故障</strong>：事务内部故障可分为预期的和非预期的，其中大部分的故障都是非预期的。预期的事务内部故障是指可以通过事务程序本身发现的事务内部故障; 非预期的事务内部故障是不能由事务程序处理的，如运算溢出故障、并发事务死锁故障、违反了某些完整性限制而导致的故障等。

 (2) <strong>系统故障</strong>：系统故障也称为软故障，是指数据库在运行过程中，由于硬件故障、数据库软件及操作系统的漏洞、突然停电灯情况，导致系统停止运转，所有正在运行的事务以非正常方式终止，需要系统重新启动的一类故障。这类事务不破坏数据库，但是影响正在运行的所有事务。 

 (3) <strong>介质故障</strong>：介质故障也称为硬故障，主要指数据库在运行过程中，由于磁头碰撞、磁盘损坏、强磁干扰、天灾人祸等情况，使得数据库中的数据部分或全部丢失的一类故障。

 (4) <strong>计算机病毒故障</strong>：计算机病毒故障是一种恶意的计算机程序，它可以像病毒一样繁殖和传播，在对计算机系统造成破坏的同时也可能对数据库系统造成破坏(破坏方式以数据库文件为主) 。

对于<strong>事务内部的故障</strong>主要采取<strong>redo+undo</strong>进行恢复
- 对于已经提交的事务，采取redo
- 对于尚未提交的事务，采取undo
